<% include ../partials/header %>

<div class="col-sm-6 col-sm-offset-3">
  <% if (user.picUrl) { %>
    <div class="avatar margin-right"><img src="<%= user.picUrl %>" class="avatar-image"></div>
  <% } %>
  <% if (typeof loggedInUser != 'undefined' && loggedInUser.email == user.email) { %>
    <h1><%= user.firstname + " " + user.lastname %>'s compositions (you)</h1>
  <% } else { %>
    <h1><%= user.firstname + " " + user.lastname %>'s compositions</h1>
  <% } %>
  <table class="table table-hover">
    <thead>
        <th>Playback</th>
        <th>Melody String</th>
        <% if (typeof loggedInUser != 'undefined' && loggedInUser.email == user.email) { %>
          <th>Delete </th>
        <% } %>
      </tr>
    </thead>
    <tbody>
    <% user.compositions.forEach(function(composition) { %>
      <tr>
        <td colspan="3">
          <div id="abc-<%= composition.id %>" class="abc"></div>
          <script type="text/javascript">
            var string = '%%staffwidth 400\n%%editable false\nX:1\nM: 6/8\nL: 1/8\nK: Emin\n"C" \^A,2B z3|"A\u266d" =e2_E GE2|"F\u266fm" F^FG A3|]\n';
            ABCJS.renderAbc('abc-<%= composition.id %>', string);
          </script>
        </td>
      </tr>
      <tr>
        <td><button data-id="<%= composition.melody %>" class="playback-button play btn btn-primary"><i class="glyphicon glyphicon-play"></i></button></td>
        <td><a href="/compositions/<%= composition.id %>"><%= composition.melody %></a></td>
        <% if (typeof loggedInUser != 'undefined' && loggedInUser.email == user.email) { %>
          <td><button data-id="/compositions/<%= composition.id %>" class="delete-button btn btn-danger"><i class="glyphicon glyphicon-remove"></i></button></td>
        <% } %>
      </tr>
    <% }) %>
    </tbody>
  </table>
</div>
<% include ../partials/footer %>