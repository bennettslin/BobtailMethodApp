<% include ../partials/header %>

<div class="container">
  <div class="row">
    <div class="col-sm-8 col-sm-offset-2">
      <h1>Compositions show page</h1>
      <ul class="list-group">
        <li class="list-group-item">Melody: <%= composition.melody %></li>
        <li class="list-group-item">Harmony: <%= composition.harmony %></li>
      </ul>
      <a href="" data-id="<%= composition.melody %>" class="music-button btn btn-warning btn-xs"><i class="glyphicon glyphicon-music"></i></a>
      <h1>Critiques</h1>
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Critic</th>
            <th>Comment</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody>
        <% composition.critiques.forEach(function(critique) { %>
          <tr>
            <td><a href="/users/<%= critique.userId %>"><%= critique.criticName %></a></td>
            <td><%= critique.comment %></td>
            <td><%= critique.createdAt %></td>
          </tr>
        <% }) %>
        </tbody>
      </table>
      <% if (typeof loggedInUser != 'undefined' && loggedInUser) { %>
        <form class="form" action="/critiques" method="POST">
          <legend>New critique</legend>
          <div class="form-group col-sm-4">
            <input type="text" class="form-control" name="comment" placeholder="Add a comment">
            <input type="hidden" name="id" value="<%= composition.id %>">
          </div>
          <div class="form-group col-sm-4">
            <button type="submit" class="btn btn-primary">Submit</button>
          </div>
        </form>
      <% } %>
    </div>
  </div>
</div>

<% include ../partials/footer %>